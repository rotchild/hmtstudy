// Generated by CoffeeScript 1.6.3
/*
    mysql数据库连接类
    class Db
*/


(function() {
  var Db, config, mysql, pool,
    __slice = [].slice;

  mysql = require('mysql');

  config = require('../../settings');

  pool = mysql.createPool(config.mysql);

  Db = (function() {
    function Db() {}

    Db.query = function() {
      var callback, str, _i;
      str = 2 <= arguments.length ? __slice.call(arguments, 0, _i = arguments.length - 1) : (_i = 0, []), callback = arguments[_i++];
      if (process.env.debug) {
        console.log(str.join());
      }
      return pool.getConnection(function(err, connection) {
        if (err) {
          return callback(err);
        }
        connection.query.apply(connection, __slice.call(str).concat([function(err, results, fields) {
          if (err) {
            connection.emit('error');
          }
          return callback(err, results, fields);
        }]));
        return connection.release();
      });
    };

    return Db;

  })();

  module.exports = Db;

}).call(this);

/*
//@ sourceMappingURL=db.map
*/
